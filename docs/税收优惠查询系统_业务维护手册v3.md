# 税收优惠政策查询系统 - 业务维护手册

> 更新日期: 2026年1月16日  
> 适用人员: 财务人员、税务专员、系统维护人员  
> 文档目的: 帮助业务人员理解系统查询逻辑，指导后续数据维护工作

---

## 一、系统概述

本系统用于查询税收优惠政策，支持用户使用自然语言提问（如"小微企业有哪些优惠"），系统自动匹配并返回相关政策条款。

**核心能力**:

- 理解用户问题中的税种、优惠类型、适用主体
- 在657条优惠政策中智能匹配相关条款
- 支持按税种筛选或跨税种综合查询

---

## 二、数据库结构（业务视角）

### 2.1 政策数据表字段说明

系统存储的每一条优惠政策包含以下信息：

| 字段名称 | 业务含义 | 录入说明 |
|----------|----------|----------|
| 税种 | 该优惠适用的税种 | 如"增值税"、"企业所得税"，必须使用标准名称 |
| 优惠项目 | 优惠政策的名称 | 如"小微企业"、"高新技术企业"，简明扼要 |
| 认定条件 | 享受优惠需满足的资格 | 详细描述适用条件，如企业规模、行业等 |
| 优惠方式 | 优惠的具体形式 | 如"免征"、"减半征收"、"即征即退" |
| 具体规定 | 政策的详细内容 | 完整描述优惠幅度、计算方法等 |
| 法律依据 | 政策的法规来源 | 文号、发布日期等 |
| 关键词 | 便于搜索的标签 | **重要**：影响查询准确性，详见第四节 |

### 2.2 现有税种与数据量

| 税种 | 政策条数 | 说明 |
|------|----------|------|
| 增值税 | 247条 | 数量最多，涵盖各类免征、即征即退政策 |
| 个人所得税 | 180条 | 包括各类扣除、免税项目 |
| 企业所得税 | 119条 | 包括小型微利企业、高新技术企业等 |
| 印花税 | 29条 | |
| 房产税 | 28条 | |
| 城镇土地使用税 | 21条 | |
| 消费税 | 15条 | |
| 土地增值税 | 10条 | |
| 资源税 | 8条 | |

---

## 三、查询逻辑说明（白话版）

### 3.1 系统如何理解用户问题

当用户提问时，系统会分析问题中的三类关键信息：

1. **税种**：用户是否指定了具体税种？
   - 明确指定：如"增值税优惠有哪些" → 只查增值税
   - 未指定：如"小微企业优惠有哪些" → 查所有税种

2. **主体/行业关键词**：用户关注的是哪类企业或哪个行业？
   - 例如：小微企业、高新技术企业、农业、软件行业等

3. **优惠类型**：用户关注哪种优惠方式？
   - 例如：减免、免征、退税、补贴等

### 3.2 查询策略

系统采用"由精确到宽泛"的查询策略：

**策略一：用户明确指定了税种**
> 例：用户问"企业所得税小微企业优惠"
>
> 系统做法：只在"企业所得税"范围内查找包含"小微企业"相关内容的政策

**策略二：用户未指定税种，但提到了特定主体**
> 例：用户问"小微企业优惠有哪些"
>
> 系统做法：在**所有税种**中查找与"小微企业"相关的政策，包括增值税的小规模纳税人优惠、企业所得税的小型微利企业优惠等

**策略三：无法识别具体意图**
> 例：用户问"今年新出的税收优惠"
>
> 系统做法：提取问题中的关键词进行模糊匹配

### 3.3 同义词处理

财税领域存在同一概念的多种表述，系统会自动扩展搜索：

| 用户说 | 系统同时搜索 |
|--------|--------------|
| 小微企业 | 小微企业、小型微利企业、小微 |
| 高新技术企业 | 高新技术企业、高新企业 |

**这意味着**：用户问"小微企业优惠"时，系统也会找到标注为"小型微利企业"的政策。

---

## 四、数据维护指南

### 4.1 新增政策条款时的注意事项

录入新政策时，请特别注意以下字段的填写：

#### ① 税种（必填，标准化）

**必须**使用以下标准名称之一：

- 增值税
- 企业所得税
- 个人所得税
- 印花税
- 房产税
- 城镇土地使用税
- 消费税
- 土地增值税
- 资源税
- 车船税
- 契税
- 关税

> ⚠️ 不要使用缩写（如"增税"）或非标准表述（如"增值税及附加"）

#### ② 优惠项目（简明准确）

使用简洁、准确的名称，便于用户理解和搜索。

**好的示例**：

- ✅ 小微企业
- ✅ 金融机构小微企业贷款利息
- ✅ 高新技术企业

**不好的示例**：

- ❌ 关于支持小型微利企业发展的若干优惠政策（太长）
- ❌ 优惠政策1（无意义）

#### ③ 关键词（影响查询准确性，非常重要）

关键词字段直接影响用户能否搜索到该政策。建议包含：

1. **税种名称**：如"增值税"
2. **适用主体**：如"小微企业"、"高新技术企业"、"农业"
3. **优惠方式**：如"免征"、"减半"、"即征即退"
4. **核心业务词**：如"研发费用"、"残疾人就业"

**示例**：
> 政策：小型微利企业减免企业所得税  
> 关键词建议：`企业所得税 优惠 减免 小型微利企业 小微企业`

> ⚠️ 注意：如果政策名称是"小型微利企业"，请在关键词中**同时**包含"小微企业"，确保用户用任一表述都能找到。

#### ④ 具体规定（详细描述）

如果政策适用于特定规模的企业，请在"具体规定"或"认定条件"中明确描述，例如：

- "月销售额10万元以下"
- "从业人员不超过300人"
- "资产总额不超过5000万元"

这些内容也会被系统搜索匹配。

### 4.2 新增税种时的维护

如果国家新设税种，需要：

1. **通知系统管理员**在程序中添加新税种到识别列表
2. **使用标准名称**录入相关政策
3. **测试验证**：录入后，测试"XX税优惠有哪些"能否正确返回结果

### 4.3 数据维护检查清单

新增或修改政策后，请自查：

- [ ] 税种名称是否标准化？
- [ ] 优惠项目名称是否简洁易懂？
- [ ] 关键词是否包含常见的用户搜索词？
- [ ] 同义词是否都已覆盖？（如"小微企业"和"小型微利企业"）
- [ ] 认定条件是否详细描述了适用标准？

---

## 五、常见问题解答

### Q1: 为什么用户搜索某个政策找不到？

**可能原因**：

- 关键词字段未包含用户使用的搜索词
- 税种名称使用了非标准表述
- 政策使用了专业术语，用户使用了通俗说法

**解决方法**：

- 在关键词中补充常见的通俗表述
- 检查并修正税种名称

### Q2: "小微企业"和"小型微利企业"有什么区别？

- **小微企业**：通常指增值税意义上的小规模纳税人
- **小型微利企业**：企业所得税法中的特定定义（从业人员、资产、应纳税所得额有具体标准）

系统已配置两者的同义词关联，用户搜索任一表述都能同时匹配两类政策。

### Q3: 如何确保新增政策能被正确搜索到？

录入后，请使用以下问法测试：

1. "[税种]优惠有哪些" - 测试税种筛选
2. "[主体类型]优惠有哪些" - 测试主体匹配
3. "[具体业务]优惠政策" - 测试业务场景匹配

---

## 六、联系与支持

如遇以下情况，请联系系统管理员：

- 需要添加新的税种
- 需要添加新的同义词映射
- 发现查询结果不准确
- 需要批量导入政策数据

---

## 七、系统管理员维护指南（简化版）

> **重要更新**：系统已支持配置外置化和自动化维护，大部分操作无需修改代码。

### 7.1 场景判断：是否需要管理员介入？

| 场景 | 处理方式 |
|------|----------|
| 新增已有税种的政策 | ✅ 财务人员直接录入，无需管理员 |
| 新增已有主体类型的政策 | ✅ 财务人员直接录入，无需管理员 |
| 批量导入政策数据 | 🔧 运行自动化脚本（见7.2） |
| 新增**新税种/新主体类型** | 🔧 运行自动化脚本（见7.2） |

### 7.2 标准维护流程（推荐）

数据库数据变更后，按以下步骤执行：

```
步骤1: python tools/rebuild_fts_index.py   ← 重建搜索索引
步骤2: python tools/update_tax_config.py   ← 更新配置（自动检测新税种/实体）
步骤3: 审核配置变更报告
```

**详细说明**：

#### 步骤1：重建FTS索引

```bash
cd D:\MyProjects\MCP_coze
python tools/rebuild_fts_index.py
```

功能：

- 自动检测主表与索引是否同步
- 重建全文搜索索引
- 对缺少关键词的记录，调用AI自动生成

#### 步骤2：更新配置文件

```bash
python tools/update_tax_config.py
```

功能：

- 扫描数据库，检测新增的税种和实体关键词
- 调用AI分析，建议新的同义词映射
- 自动更新 `config/tax_query_config.json`
- 生成变更报告供审核

#### 步骤3：审核配置

查看变更报告：`tools/config_update_report.md`

如需手动调整，编辑：`config/tax_query_config.json`

配置修改后**自动生效**，无需重启服务。

### 7.3 配置文件说明

配置文件位置：`config/tax_query_config.json`

| 配置项 | 说明 |
|--------|------|
| `tax_types` | 系统识别的税种列表 |
| `tax_fuzzy_map` | 税种模糊匹配（如"企业所得"→"企业所得税"） |
| `core_entity_keywords` | 核心实体关键词（如"小微企业"、"高新技术"） |
| `entity_synonyms` | 实体同义词映射 |
| `incentive_keywords` | 优惠方式关键词 |

### 7.4 手动编辑配置（可选）

如需手动添加配置，直接编辑 JSON 文件：

```json
{
  "tax_types": ["增值税", "企业所得税", "新税种"],
  "core_entity_keywords": ["小微企业", "高新技术", "新主体"],
  "entity_synonyms": {
    "新主体": ["新主体", "新主体的同义词"]
  }
}
```

保存后自动生效。

### 7.5 回滚配置

配置备份目录：`config/backups/`

如需回滚，将备份文件复制回 `config/tax_query_config.json`。

---

*本手册旨在帮助业务人员理解系统运作逻辑，确保数据维护质量，提升用户查询体验。*
